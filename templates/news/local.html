{% extends 'news/base.html' %}
{% load static %}

{% block title %}
    Mahalliy Yangiliklar — NewsFeed
{% endblock title %}

{% block css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/custom-news.css' %}">
<style>
/* Minimal inline styles — agar siz custom-news.css dan foydalansangiz, bu qismini olib tashlashingiz mumkin */
.news-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.25rem;
  align-items: start;
  margin-top: 1.25rem;
}
.news-card {
  border: 1px solid #e6e6e6;
  border-radius: 10px;
  overflow: hidden;
  background: #fff;
  box-shadow: 0 6px 18px rgba(0,0,0,0.04);
  transition: transform .18s ease, box-shadow .18s ease;
}
.news-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 14px 30px rgba(0,0,0,0.08);
}
.news-card .thumb {
  width: 100%;
  height: 180px;
  object-fit: cover;
  display: block;
}
.news-card .card-body {
  padding: 0.9rem 1rem;
}
.news-card .title {
  font-size: 1.05rem;
  font-weight: 600;
  margin: 0 0 0.5rem;
  color: #212529;
  text-decoration: none;
}
.news-card .excerpt {
  color: #6c757d;
  font-size: 0.95rem;
  margin-bottom: .6rem;
  min-height: 2.7rem;
}
.news-meta {
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size: .85rem;
  color:#868e96;
  padding: 0 1rem 1rem;
}
.read-more {
  font-weight: 600;
  color:#0d6efd;
  text-decoration:none;
}
.read-more:hover { text-decoration:underline; }
@media (max-width:576px){
  .news-card .thumb { height:140px; }
}
</style>
{% endblock css %}

{% block content %}
<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h3 mb-0">Mahalliy Yangiliklar</h1>
    <a href="{% url 'local_news_page' %}" class="btn btn-outline-primary btn-sm">Barcha yangiliklar</a>
  </div>

  {% if local_news %}
    <div class="news-grid">
      {% for news in local_news %}
        <article class="news-card">
          <a href="{{ news.get_absolute_url }}">
            {% if news.image %}
              <img src="{{ news.image.url }}" alt="{{ news.title }}" class="thumb" loading="lazy">
            {% else %}
              <img src="{% static 'images/no_image.jpg' %}" alt="No image" class="thumb" loading="lazy">
            {% endif %}
          </a>

          <div class="card-body">
            <a href="{{ news.get_absolute_url }}" class="title">{{ news.title }}</a>
            <p class="excerpt">
              {{ news.body|truncatewords:28 }}
            </p>
          </div>

          <div class="news-meta">
            <small>{{ news.publish_time|date:"d M Y H:i" }}</small>
            <a href="{{ news.get_absolute_url }}" class="read-more">Batafsil →</a>
          </div>
        </article>
      {% endfor %}
    </div>

    {# Optional: pagination block (agar view paginate qilsa) #}
    {% if is_paginated %}
      <nav class="mt-4" aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          {% if page_obj.has_previous %}
            <li class="page-item">
              <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">&laquo;</a>
            </li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
          {% endif %}

          {% for num in paginator.page_range %}
            {% if page_obj.number == num %}
              <li class="page-item active"><span class="page-link">{{ num }}</span></li>
            {% elif num > page_obj.number|add:-3 and num < page_obj.number|add:3 %}
              <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
            {% endif %}
          {% endfor %}

          {% if page_obj.has_next %}
            <li class="page-item">
              <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">&raquo;</a>
            </li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
          {% endif %}
        </ul>
      </nav>
    {% endif %}

  {% else %}
    <div class="alert alert-secondary my-4">
      Hozircha mahalliy yangiliklar mavjud emas.
    </div>
  {% endif %}
</div>
{% endblock content %}
